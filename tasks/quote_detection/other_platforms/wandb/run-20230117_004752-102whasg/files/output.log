Some weights of the model checkpoint at google/bigbird-roberta-base were not used when initializing BigBirdModel: ['cls.seq_relationship.bias', 'cls.seq_relationship.weight', 'cls.predictions.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.transform.dense.bias', 'cls.predictions.decoder.weight', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.decoder.bias']
- This IS expected if you are initializing BigBirdModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BigBirdModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
***** Running training *****
  Num examples = 2
  Num Epochs = 3
  Instantaneous batch size per device = 1
  Total train batch size (w. parallel, distributed & accumulation) = 1
  Gradient Accumulation steps = 1
  Total optimization steps = 6
Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"
  0%|          | 0/6 [00:00<?, ?it/s]Attention type 'block_sparse' is not possible if sequence_length: 673 <= num global tokens: 2 * config.block_size + min. num sliding tokens: 3 * config.block_size + config.num_random_blocks * config.block_size + additional buffer: config.num_random_blocks * config.block_size = 704 with config.block_size = 64, config.num_random_blocks = 3. Changing attention type to 'original_full'...
    2 training samples
    2 validation samples
Python 3.7.6 (default, Jan  8 2020, 13:42:34)
Type 'copyright', 'credits' or 'license' for more information
IPython 7.22.0 -- An enhanced Interactive Python. Type '?' for help.
PyDev console: using IPython 7.22.0
Out[1]:
tensor([[ 0.0657,  0.2710, -0.5219,  ..., -0.5356, -0.3144, -0.0517],
        [ 0.0705, -0.0393, -0.0343,  ...,  0.1301, -0.0171, -0.1084],
        [-0.0618, -0.1090, -0.0867,  ..., -0.0797,  0.0475,  0.1062],
        [ 0.0064, -0.0395, -0.2069,  ..., -0.0237,  0.0219,  0.0982],
        [ 0.1433, -0.1532, -0.2125,  ...,  0.0718,  0.1583,  0.2306],
        [ 0.3078, -0.1171, -0.0818,  ...,  0.3489, -0.0231,  0.0357]],
       grad_fn=<SliceBackward0>)
Traceback (most recent call last):
  File "/Users/alex/opt/anaconda3/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 3437, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-2-b6a79bea0da6>", line 1, in <module>
    sent_word_embss.shape
NameError: name 'sent_word_embss' is not defined
Traceback (most recent call last):
  File "/Users/alex/opt/anaconda3/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 3437, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-3-687f7f782f78>", line 1, in <module>
    sent_word_embss
NameError: name 'sent_word_embss' is not defined
Out[4]:
tensor([[ 0.0657,  0.2710, -0.5219,  ..., -0.5356, -0.3144, -0.0517],
        [ 0.0705, -0.0393, -0.0343,  ...,  0.1301, -0.0171, -0.1084],
        [-0.0618, -0.1090, -0.0867,  ..., -0.0797,  0.0475,  0.1062],
        [ 0.0064, -0.0395, -0.2069,  ..., -0.0237,  0.0219,  0.0982],
        [ 0.1433, -0.1532, -0.2125,  ...,  0.0718,  0.1583,  0.2306],
        [ 0.3078, -0.1171, -0.0818,  ...,  0.3489, -0.0231,  0.0357]],
       grad_fn=<SliceBackward0>)
Out[5]: torch.Size([6, 768])
Out[6]:
tensor([[ 8.5733e-02,  2.6636e-02, -2.5530e-01,  3.6717e-02,  5.5366e-01,
         -4.7110e-02, -1.9024e-01,  2.2857e-02,  1.9358e-01, -2.0190e-01,
          2.8725e-01,  6.7431e-02,  4.3340e-02, -1.8331e-01,  6.1022e-02,
          6.3270e-02,  3.0515e-01,  4.9369e-02, -8.5327e-02,  3.2700e-01,
         -1.0668e-01, -1.8281e-01,  3.0732e-01, -7.8460e-02,  3.2021e-01,
         -8.5827e-02,  1.0436e-01,  2.4977e-01,  7.3131e-02, -3.1132e-01,
          2.8598e-02,  1.4715e-01,  6.9278e-02, -1.3752e-01, -9.3033e-02,
          1.9691e-02,  2.9297e-01,  3.9840e-02,  2.6699e-01, -6.0210e-03,
          1.9215e-01, -3.1897e-02,  1.5957e-01,  3.2262e-02,  8.7796e-02,
         -9.4640e-02, -1.8783e-01,  3.7170e-01, -2.7225e-02,  2.5062e-01,
         -7.2855e-02, -3.3732e-02,  6.7058e-02, -1.6689e-01, -2.7559e-01,
          1.5898e-01,  3.1718e-02,  2.0779e-01, -2.0062e-01, -1.9261e-01,
          1.2173e-01, -1.3366e-01,  3.8335e-01, -6.2253e-02,  3.7955e-02,
         -2.2614e-01, -1.4584e-01,  1.0092e-01,  2.2835e-01,  2.5417e-02,
         -6.2151e-02, -5.7862e-02, -1.3532e-01,  6.2168e-02, -2.1629e-01,
         -6.4208e-02,  8.6169e-02, -9.3774e-01,  2.4188e-01,  5.2302e-02,
          1.7628e-01,  1.4442e-01, -1.0769e+00,  1.8189e-02,  1.6001e-01,
         -3.7050e-02, -5.2514e-02,  1.4638e-01, -3.9566e-02,  9.3157e-02,
          1.8415e-01, -3.2506e-02,  2.2821e-01,  2.7891e-01, -1.3020e-01,
         -3.1993e-01, -3.6072e-02, -2.4242e-01, -1.8196e-01, -1.3765e-01,
          1.5992e-02, -8.0584e-02,  1.6870e-01, -9.8935e-02,  4.5613e-02,
          1.0941e-01, -3.5893e-01, -1.7364e-01,  1.1646e-01, -1.8879e-01,
          9.4041e-02,  2.1016e-01, -5.4795e-02, -4.9780e-02,  3.1977e-01,
         -1.9377e-03,  1.5139e-03,  2.1334e-03,  1.9489e-02,  1.6298e-01,
          1.1936e-01, -3.9120e-02,  1.2049e-01,  1.7743e-01,  1.5061e-01,
         -2.8805e-02, -1.0511e-01,  6.3442e-02, -1.2677e-01,  7.9835e-02,
          2.2554e-01, -1.9207e-01,  6.3197e-02, -9.1888e-02,  8.6444e-02,
         -1.0805e-01,  8.2900e-02,  1.4417e-01, -7.0393e-02,  1.1221e-01,
          3.8749e-02,  3.7687e-01,  4.3066e-02,  1.0298e-01,  1.6565e-01,
         -1.9225e-01, -4.6274e-01, -2.8107e-01,  8.0061e-02, -2.9733e-02,
         -1.7868e-01,  2.4578e-01, -8.4285e-03,  1.6355e-01, -2.2791e-01,
         -1.0981e-01,  1.2430e-01, -1.0777e-01,  4.6363e-02,  1.2075e-01,
          4.2798e-01,  6.6858e-02,  3.2251e-01,  1.7634e-01,  4.0907e-01,
          1.3102e-01, -1.8461e-01,  1.5048e-02, -1.9130e-01,  3.3802e-01,
          1.6236e-01,  1.3865e-01, -2.2665e-01, -5.4031e-02,  5.3434e-02,
          4.8977e-03,  2.2887e-01,  4.2150e-02, -1.0669e-01, -1.6999e-01,
         -2.0256e-03,  1.0463e-01, -8.0788e-02, -1.3329e-01,  2.7886e-01,
          8.0314e-02, -2.5207e-01,  1.4623e-01, -9.7453e-02, -1.0771e-01,
          1.0535e-01, -6.0489e-03,  4.5669e-03,  5.8879e-03, -2.3285e-01,
         -1.5306e-01, -1.2167e-01,  2.7955e-02,  2.1856e-02, -1.2935e-02,
         -9.2600e-03, -3.0457e-01, -9.4236e-02,  1.4472e-01,  6.9353e-02,
          2.6602e-02, -1.2543e-02,  2.9722e-01,  3.1437e-02,  8.9357e-02,
         -7.5865e-02,  1.2783e-02,  7.3380e-02,  1.4354e-01, -4.1849e-01,
          1.2661e-01,  4.4645e-02, -4.3451e-02, -5.1817e-02,  1.2349e-01,
          6.7334e-02,  1.2133e-01,  1.0062e-01, -1.5047e-02,  1.5146e-01,
          1.4688e-02,  2.3701e-01,  1.8129e-01,  1.4853e-01, -2.0294e-01,
         -1.1180e-01,  4.0375e-02,  1.6552e-01,  1.2927e-01,  2.6100e-01,
         -1.5578e-01,  1.8333e-01, -1.5114e-01, -8.5197e-03, -2.8913e-01,
         -3.2423e-01,  5.7134e-02, -1.6596e-01,  4.2428e-02, -8.5999e-02,
          1.5199e-01,  1.3845e-01,  1.3511e-01,  6.2565e-02,  1.3266e-01,
         -4.9560e-02,  4.8936e-02,  1.8491e-01,  1.3659e-02,  2.0803e-01,
          1.7513e-01,  5.3553e-02,  2.1788e-01,  1.7476e-01, -7.5860e-04,
         -1.9711e-01,  1.4717e-01,  1.6521e-01,  4.3232e-01,  4.7253e-02,
         -1.0325e-01,  6.3108e-02,  1.8329e-01,  4.5577e-02,  4.4423e-02,
          7.4660e-02,  1.4428e-02,  2.1331e-01,  2.0606e-01, -1.2924e-01,
          1.0912e-01, -9.0232e-02,  4.5602e-02,  9.8841e-02, -5.7602e-02,
         -1.1879e-01,  4.5972e-02, -5.5616e-02,  1.5498e-01, -8.8398e-02,
          1.6346e-01, -9.2425e-02, -2.2068e-01,  2.0919e-02,  3.2767e-01,
          2.0878e-01, -1.5441e-02, -1.9045e-02, -9.5304e-02, -2.9307e-01,
          9.2972e-02, -1.1198e-02,  9.3983e-02,  9.6070e-02,  9.7219e-02,
         -6.0349e-02, -6.9001e-02,  1.0392e-01, -1.3194e-02,  2.4026e-01,
         -2.5373e-01, -1.4380e-01, -1.1483e-01,  8.0903e-03,  1.5851e-01,
         -2.2574e-01,  1.5332e-01, -9.9865e-03,  9.4005e-02, -3.1338e-03,
         -5.5820e-02, -1.0467e-01, -2.6531e-01, -7.6441e-02,  7.0574e-03,
         -1.0230e-01, -3.5297e-02, -4.4168e-02, -7.8730e-02, -1.0206e-01,
          8.0850e-02, -1.2734e-01,  6.9029e-02,  4.8283e-04,  8.1921e-02,
          5.1851e-01,  7.0908e-01,  2.7494e-01, -9.7841e-02,  2.1442e-02,
         -1.7846e-01, -2.0107e-01,  1.7157e-01,  6.0450e-02, -2.3198e-02,
          2.1941e-01, -7.0544e-02,  6.1275e-02, -1.1336e-01, -1.9300e-03,
         -6.9344e-02, -1.0378e-02, -6.2218e-02, -1.4194e-01,  2.8643e-01,
         -6.9930e-02, -3.7439e-02,  6.2021e-02, -3.8067e-01, -7.6102e-02,
          3.4504e-01, -2.5842e-02,  8.5575e-02, -1.8455e-01,  3.2271e-01,
          8.0829e-03,  2.9435e-01,  3.6146e-01, -4.9134e-02,  2.6655e-01,
         -5.6219e-02,  8.5921e-02, -6.4948e-02, -6.6349e-02,  2.5835e-02,
          1.4641e-01,  5.0763e-02,  1.2730e-01, -8.0186e-02,  1.7879e-02,
         -1.2905e-01,  2.0803e-01,  1.2660e-01,  2.4237e-02, -8.4333e-02,
          1.6837e-01,  2.5656e-01,  1.1811e-01,  4.2168e-02, -1.7757e-01,
         -1.2570e-01,  5.0127e-04,  5.7238e-02, -1.0792e-01, -1.9428e-02,
          2.2753e-01, -1.5537e-01, -4.6121e-02,  1.8703e-01,  1.7399e-02,
         -1.1653e-01,  1.4452e-01, -2.1742e-01,  1.3380e-01,  2.9255e-01,
          3.1015e-02, -1.0147e-01,  1.3541e-01,  2.7211e-01, -1.4813e-02,
          2.6931e-01, -2.6736e-03,  2.1184e-01,  2.6462e-01, -1.0313e-01,
          6.1244e-02,  8.7272e-02,  6.1077e-02,  3.6519e-02,  3.9209e-02,
         -1.0847e-02,  2.7166e-01, -1.1385e-01, -6.4444e-02,  2.4740e-01,
         -2.1303e-02, -3.2389e-01,  1.5382e-01,  9.2288e-02, -1.2977e-01,
          1.4996e-02,  1.6956e-01, -1.8314e-01, -2.3992e-01, -4.0834e-03,
         -1.0352e-01,  1.0107e-01,  1.1813e-01, -1.0091e-01, -2.4561e-01,
          7.9470e-02,  8.1388e-02,  1.3138e-01, -2.9963e-01, -2.5682e-01,
         -3.4601e-02,  1.5708e-01, -2.0949e-02,  6.1071e-02,  1.7571e-01,
          3.0796e-01,  3.5216e-01, -5.1445e-03,  3.4344e-01,  2.3039e-01,
          3.5785e-01,  1.2912e-01, -5.7411e-02, -7.7982e+00, -2.2659e-01,
         -1.5113e-01,  2.4963e-01,  2.4509e-01, -1.7719e-02, -7.7626e-02,
          1.6343e-01,  9.7721e-02, -6.5265e-02, -4.3065e-02, -3.9627e-01,
         -3.1058e-01,  1.3325e-01,  1.9701e-01, -2.1249e-02, -9.3584e-02,
          3.2879e-01,  3.6524e-02,  9.1984e-02,  1.1835e-01,  8.5001e-02,
          7.9508e-03,  2.3963e-01, -4.0433e-02,  5.4020e-02,  1.1649e-01,
         -2.4402e-01, -1.4891e-02,  1.2808e-01,  3.5178e-02,  1.9434e-01,
         -7.4013e-02, -2.3663e-02, -1.7171e-01, -7.8981e-02,  3.3030e-02,
         -1.8112e-01, -1.3536e-01,  1.4324e-01,  3.2666e-01, -4.3313e-01,
          1.5125e-01,  5.5452e-02,  3.1396e-01, -3.5003e-02,  8.5213e-02,
          3.1658e-02, -6.1401e-02,  2.3018e-01, -5.4858e-02,  2.2744e-01,
          2.3003e-02, -3.4098e-02, -2.0679e-01, -9.2912e-02,  1.2192e-01,
         -1.1055e-02,  1.2486e-01, -1.1582e-01,  1.8705e-01, -9.1315e-02,
          2.7439e-01, -2.9267e-02,  2.0192e-01, -1.8638e-02,  2.3729e-02,
          2.4787e-01, -4.9877e-02,  1.1780e-01,  5.7298e-02,  6.6206e-02,
         -2.3901e-01, -4.0027e-04,  6.4541e-02,  1.3812e-01, -3.6705e-02,
          3.0084e-01,  2.1448e-02,  4.7765e-02,  1.0981e-01, -3.7094e-01,
         -7.1263e-03,  1.3238e-01, -1.5956e-01, -3.5557e-01, -1.4536e-02,
          3.6563e-01,  6.9294e-02, -1.2781e-01,  2.0518e-01, -2.3524e-02,
          3.6158e-02, -1.0701e-01,  1.6880e-01, -4.3278e-03,  2.0604e-01,
          1.0572e-01,  9.4117e-01,  1.0567e-02,  1.2825e-03,  2.6395e-01,
          8.4597e-02,  1.8901e-01,  1.7417e-01, -3.6881e-01,  3.2347e-01,
         -1.7924e-01,  3.1674e-02, -1.9917e-01, -2.8232e-02, -2.4611e-01,
          3.2608e-02,  9.5732e-02,  2.5264e-02, -1.1898e-02,  6.1512e-02,
         -1.5564e-01,  3.2465e-01, -9.2125e-03,  3.2008e-01,  1.4684e-01,
          6.9755e-02,  4.3045e-01,  1.5133e-01, -2.1613e-01, -5.0915e-02,
          1.3563e-03, -3.5489e-01,  1.8564e-01, -7.3996e-02, -1.9364e-01,
          6.7902e-02, -1.9803e-02, -1.6884e-01,  6.1105e+00,  1.2397e-02,
         -5.7168e-02,  8.2416e-02, -7.1429e-02,  2.1958e-02, -1.1626e-01,
         -5.3555e-02,  2.0357e-01,  1.4807e-01, -7.3717e-02, -3.0023e-01,
          3.6321e-02, -9.1771e-02, -6.7814e-03,  8.9465e-02,  2.1786e-01,
         -3.6689e-01,  5.1840e-02, -1.4983e-01, -1.6532e-01,  3.9020e-02,
          5.1595e-02,  2.3110e-01, -1.6672e-01,  9.4614e-02, -1.2600e-01,
          2.8572e-02,  2.5884e-03, -5.4468e-02,  6.4712e-02, -4.3827e-03,
          2.4208e-01,  2.0377e-01,  2.7014e-01,  9.8927e-02, -3.6668e-02,
          2.3613e-02, -1.0028e-01,  2.8255e-01,  1.6875e-01,  8.3572e-02,
          2.2425e-02,  1.6380e-01,  1.6217e-01, -9.1661e-02, -5.8135e-02,
         -4.0347e-02, -1.3814e-01,  4.0620e-02,  3.0567e-02, -4.8899e-02,
          3.7490e-02, -1.3919e-02, -2.2296e-01, -3.6939e-02,  2.7479e-02,
         -5.3116e-03, -8.1834e-02, -2.0074e-01,  2.7293e-01,  1.8229e-01,
          2.0617e-01,  3.8160e-01,  3.3089e-01,  4.1551e-01,  2.2806e-01,
          1.6516e-01, -1.0651e-01,  5.0122e-02,  8.3002e-02,  1.4552e-01,
          1.7359e-02,  7.1176e-03, -1.9898e-01,  2.3381e-01, -1.9770e-01,
         -2.7747e-01,  8.0438e-02,  1.2945e-01,  3.3193e-02,  3.0569e-01,
         -1.3607e-01, -5.8771e-02,  1.8495e-02,  1.2769e-01, -1.7913e-01,
          1.1217e-01,  1.6182e-01,  6.7497e-02, -1.5927e-01,  8.8778e-02,
          2.5514e-01,  5.9900e-02,  8.6694e-02,  1.8042e-01,  2.9622e-01,
         -9.5527e-02, -8.6855e-02,  1.4026e-01,  2.0192e-02, -6.3334e-02,
         -1.0380e-01,  1.8681e-01, -8.7655e-02,  3.7398e-01,  2.2382e-01,
          1.2474e-01, -2.4059e-01, -1.3451e-01,  1.7493e-02, -3.2014e-01,
         -1.1952e-01, -9.6874e-02, -5.2390e-02, -2.1312e-01,  1.0044e-01,
          9.7779e-02,  2.4872e-01,  6.2081e-02, -5.3252e-02, -5.5572e-02,
         -1.4308e-02,  1.9299e-01, -2.4863e-02,  1.8764e-01, -3.8832e-02,
         -1.5369e-01, -2.5779e-01, -1.3562e-01,  1.2416e-01,  5.6140e-02,
          5.9980e-02,  4.1850e-01,  1.9182e-01, -8.7843e-02, -2.5224e-01,
          2.9013e-02,  1.8543e-01,  1.3302e-01, -3.7193e-02,  7.4300e-02,
          2.2748e-01,  1.5740e-01, -9.4029e-02,  1.8272e-01,  2.7894e-01,
          1.7043e-01, -1.2853e-01, -1.1595e-01,  2.5304e-02, -1.4392e-01,
          3.4609e-02,  3.0680e-01, -1.0479e-01,  2.1166e-02,  8.4793e-02,
          5.5294e-02, -8.9144e-02,  3.3773e-02,  2.7191e-01, -1.5797e-01,
          4.5483e-01, -3.4393e-01, -8.2115e-02, -1.5881e-01, -1.2093e-01,
         -1.4614e-01, -1.1360e-02,  2.1774e-02,  1.0113e-01, -3.2456e-01,
         -1.4575e-03,  1.0086e-01,  6.1563e-02, -8.0293e-02, -1.9374e-01,
         -1.1095e-01, -7.6361e-02,  3.2628e-02]], grad_fn=<SqueezeBackward1>)
Out[7]: torch.Size([1, 768])
